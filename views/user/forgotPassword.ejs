<link rel='stylesheet' href='/sign-assets/stylesheets/style.css' />

<div class="main h-screen flex justify-center items-center">

    <!-- Sing in  Form -->
    <section class="sign-in">
        <div class="container">
            <div class="max-w-md mx-auto text-center px-4 sm:px-8 py-10 ">
                <header class="mb-8">
                    <h1 class="text-2xl font-bold mb-1">Forgot Password</h1>
                    <p class="text-[15px] text-slate-500">Please enter the email you use to sign in</p>
                </header>
                <form id="otp-form" action="/login" method="post">




                    <div class="mb-6" id="emailDiv">
                        <div for="email" class="block text-left cent mb-2 text-sm font-medium text-gray-900">
                            Email
                            address</div>


                        <input type="email" id="email"
                            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 "
                            placeholder="john.doe@company.com" required />
                    </div>

                    <div class="hidden" id="otpDiv">
                        <p class="text-[15px] text-gray-900 pb-2">Enter the 4-digit verification code that was sent to
                            your
                            email.</p>
                        <div class="flex items-center justify-center gap-3">
                            <input type="text"
                                class="w-16 h-14 text-center text-2xl font-extrabold text-slate-900 bg-slate-100 border border-transparent hover:border-slate-200 appearance-none rounded p-4 outline-none focus:bg-white focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100"
                                pattern="\d*" maxlength="1" />
                            <input type="text"
                                class="w-16 h-14 text-center text-2xl font-extrabold text-slate-900 bg-slate-100 border border-transparent hover:border-slate-200 appearance-none rounded p-4 outline-none focus:bg-white focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100"
                                maxlength="1" />
                            <input type="text"
                                class="w-16 h-14 text-center text-2xl font-extrabold text-slate-900 bg-slate-100 border border-transparent hover:border-slate-200 appearance-none rounded p-4 outline-none focus:bg-white focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100"
                                maxlength="1" />
                            <input type="text"
                                class="w-16 h-14 text-center text-2xl font-extrabold text-slate-900 bg-slate-100 border border-transparent hover:border-slate-200 appearance-none rounded p-4 outline-none focus:bg-white focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100"
                                maxlength="1" />
                        </div>
                    </div>
                    <p id="alertMessage" class="mt-2 text-red-500">
                    </p>

                    <div class="max-w-[260px] mx-auto mt-4">
                        <button id="send" type="button" onclick="sendOtpForForgetPassword()" class="w-full inline-flex justify-center whitespace-nowrap rounded-lg bg-indigo-500
                                px-3.5 py-2.5 text-sm font-medium text-white shadow-sm shadow-indigo-950/10
                                hover:bg-indigo-600 focus:outline-none focus:ring focus:ring-indigo-300
                                focus-visible:outline-none focus-visible:ring focus-visible:ring-indigo-300
                                transition-colors duration-150">Reset Password</button>
                    </div>
                    <div class="max-w-[260px] mx-auto mt-4">
                        <button id="verify" type="button" onclick="verifyOtpForForgetPassword()" class="w-full inline-flex justify-center whitespace-nowrap rounded-lg bg-indigo-500
                                px-3.5 py-2.5 text-sm font-medium text-white shadow-sm shadow-indigo-950/10
                                hover:bg-indigo-600 focus:outline-none focus:ring focus:ring-indigo-300
                                focus-visible:outline-none focus-visible:ring focus-visible:ring-indigo-300
                                transition-colors duration-150 hidden">Verify Otp</button>
                    </div>
                </form>




                <!-- <div class="text-sm text-slate-500 mt-4">Didn't receive code? <a <span
                                class="link-dark link-opacity-25" style="text-decoration: underline;" id="resend"
                                onclick="resendOTP()">Request again</span>  -->



                <!-- <span class="font-monospace badge rounded-pill bg-info p-auto" id="timer"></span> -->
                <!-- </div> -->
            </div>
    </section>
    <!-- </div> -->


    <script>
        let sendOtpForForgetPassword = async () => {
            const email = document.getElementById('email').value
            const message = document.querySelector('#alertMessage')
            console.log("email", email);
            try {
                const res = await axios.post('/forgot-password', {
                    email
                })
                if (res.status == 200) {
                    const emailDiv = document.getElementById('emailDiv')
                    const otpDiv = document.getElementById('otpDiv')
                    const verify = document.getElementById('verify')
                    const send = document.getElementById('send')
                    emailDiv.classList.add('hidden')
                    otpDiv.classList.remove('hidden')
                    send.classList.add('hidden')
                    verify.classList.remove('hidden')
                    message.textContent = ''
                }
            } catch (error) {

                message.textContent = "Enter a registered email"
            }
        }

        const verifyOtpForForgetPassword = async () => {
            try {
                const inputs = document.querySelectorAll('#otpDiv >div>input')
                let otp = ''
                const outputs = inputs.forEach(el => otp += el.value)
                // console.log("outputs", otp);
                const res = await axios.post('/verify-otp', {
                    otp
                })
                if (res.status == 200) {
                    window.redirect('/reset-password')
                } else {
                    console.log(hiiiiii);
                    const message = document.querySelector('#alertMessage')
                    message.textContent = "Enter a valid OTP"
                }
            } catch (error) {
                const message = document.querySelector('#alertMessage')
                message.textContent = "Enter a valid OTP"
            }
        }
    </script>